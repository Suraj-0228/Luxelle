<div class="min-h-screen bg-white py-12 px-4 sm:px-6 lg:px-8">
    <div class="max-w-7xl mx-auto">
        <h1 class="text-3xl md:text-4xl font-serif font-bold text-gray-900 mb-12">Shopping Bag</h1>

        <div *ngIf="cartItems().length > 0; else emptyCart"
            class="lg:grid lg:grid-cols-12 lg:gap-x-12 lg:items-start xl:gap-x-16">

            <!-- Cart Items List -->
            <section class="lg:col-span-7">
                <div class="border-t border-gray-100 divide-y divide-gray-100">
                    <div *ngFor="let item of cartItems()" class="flex py-10">
                        <div class="flex-shrink-0 w-24 h-32 rounded-sm overflow-hidden sm:w-32 sm:h-40 bg-gray-50">
                            <img [src]="item.product.image" [alt]="item.product.name"
                                class="w-full h-full object-cover object-center">
                        </div>

                        <div class="ml-6 flex-1 flex flex-col justify-between">
                            <div class="sm:grid sm:grid-cols-2 sm:gap-x-6">
                                <div>
                                    <div class="flex justify-between">
                                        <h3 class="text-base font-medium text-gray-900">
                                            <a [routerLink]="['/product', item.product._id]"
                                                class="hover:text-gray-600 transition-colors">{{ item.product.name
                                                }}</a>
                                        </h3>
                                    </div>
                                    <p class="mt-1 text-sm text-gray-500 font-light uppercase tracking-wide">{{
                                        item.product.brand || 'LUXELLE' }}</p>
                                    <p class="mt-1 text-sm text-gray-500 font-light">{{ item.product.material }}</p>
                                    <p class="mt-4 text-base font-medium text-gray-900">${{ item.product.price }}</p>
                                </div>

                                <div class="mt-4 sm:mt-0 sm:pr-9">
                                    <div class="flex items-center space-x-4">
                                        <div class="flex items-center border border-gray-400">
                                            <button (click)="updateQuantity(item.product._id, item.quantity - 1)"
                                                class="px-3 py-2 text-gray-500 hover:bg-gray-50 transition-colors disabled:opacity-50"
                                                [disabled]="item.quantity <= 1">-</button>
                                            <span class="px-3 py-2 text-gray-900 font-medium text-sm w-8 text-center">{{
                                                item.quantity }}</span>
                                            <button (click)="updateQuantity(item.product._id, item.quantity + 1)"
                                                class="px-3 py-2 text-gray-500 hover:bg-gray-50 transition-colors">+</button>
                                        </div>
                                    </div>

                                    <div class="mt-4">
                                        <button (click)="remove(item.product._id)"
                                            class="text-xs font-bold uppercase tracking-widest text-gray-400 hover:text-red-500 transition-colors border-b border-transparent hover:border-red-500 pb-0.5">
                                            Remove
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Order Summary -->
            <section
                class="mt-16 bg-gray-50 px-8 py-10 lg:mt-0 lg:col-span-5 sticky top-8 rounded-sm border border-gray-400">
                <h2 class="text-xl font-serif font-medium text-gray-900 mb-8">Order Summary</h2>

                <dl class="space-y-4">
                    <div class="flex items-center justify-between">
                        <dt class="text-sm text-gray-600 font-light">Subtotal</dt>
                        <dd class="text-sm font-medium text-gray-900">${{ subtotal().toFixed(2) }}</dd>
                    </div>

                    <div class="flex items-center justify-between">
                        <dt class="text-sm text-gray-500 font-light">State Tax (8%)</dt>
                        <dd class="text-sm font-medium text-gray-500">+${{ stateTax().toFixed(2) }}</dd>
                    </div>

                    <div class="flex items-center justify-between">
                        <dt class="text-sm text-gray-500 font-light">Import Duty (5%)</dt>
                        <dd class="text-sm font-medium text-gray-500">+${{ importDuty().toFixed(2) }}</dd>
                    </div>

                    <div class="flex items-center justify-between">
                        <dt class="text-sm text-gray-500 font-light">Processing Fee</dt>
                        <dd class="text-sm font-medium text-gray-500">+${{ processingFee().toFixed(2) }}</dd>
                    </div>

                    <div class="flex items-center justify-between border-t border-gray-500 pt-4 mt-4">
                        <dt class="text-sm text-gray-600 font-light">Shipping</dt>
                        <dd class="text-sm font-medium text-gray-900">Calculated at checkout</dd>
                    </div>

                    <div class="border-t border-gray-500 pt-6 flex items-center justify-between">
                        <dt class="text-base font-bold text-gray-900">Total</dt>
                        <dd class="text-base font-bold text-gray-900">${{ totalPrice().toFixed(2) }}</dd>
                    </div>
                </dl>

                <div class="mt-8">
                    <button (click)="proceedToCheckout()"
                        class="w-full bg-gray-900 text-white py-4 px-8 text-sm font-bold uppercase tracking-[0.2em] hover:bg-black transition-all duration-300 shadow-md">
                        Proceed to Checkout
                    </button>
                    <p class="mt-4 text-xs text-center text-gray-500 font-light">
                        Tax included. Secure checkout via Stripe.
                    </p>
                </div>
            </section>
        </div>

        <ng-template #emptyCart>
            <div class="text-center py-32">
                <div class="inline-flex items-center justify-center w-20 h-20 bg-gray-50 rounded-full mb-6">
                    <svg class="w-8 h-8 text-gray-900" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"
                            d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                    </svg>
                </div>
                <h2 class="text-2xl font-serif text-gray-900 mb-4">Your bag is currently empty</h2>
                <p class="text-gray-500 font-light mb-10 max-w-sm mx-auto">Browse our latest collections and find
                    something you love.</p>
                <a routerLink="/shop"
                    class="inline-block bg-white border border-gray-900 text-gray-900 py-3 px-8 text-xs font-bold uppercase tracking-widest hover:bg-gray-900 hover:text-white transition-all duration-300">
                    Discover New Arrivals
                </a>
            </div>
        </ng-template>
    </div>
</div>